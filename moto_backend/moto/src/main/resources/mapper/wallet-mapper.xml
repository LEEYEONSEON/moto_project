<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.or.iei.user.model.dao.WalletDao">

    <!-- 지갑 상태 조회 -->
    <select id="selectWalletStatus" parameterType="string" resultType="kr.or.iei.user.model.dto.WalletStatusDto">
        SELECT 
            wallet_balance,
            last_updated
        FROM tbl_wallet
        WHERE user_id = #{userId}
    </select>

    <!-- 지갑 거래 내역 조회 (페이징) -->
    <select id="selectWalletHistory" parameterType="map" resultType="kr.or.iei.user.model.dto.WalletHistoryDto">
        SELECT
            transaction_id,
            amount,
            transaction_type,
            transaction_date,
            description
        FROM tbl_wallet_history
        WHERE user_id = #{userId}
        ORDER BY transaction_date DESC
        LIMIT #{limit} OFFSET #{offset}
    </select>

    <!-- 지갑 거래 내역 전체 개수 조회 -->
    <select id="selectWalletHistoryCount" parameterType="string" resultType="int">
        SELECT COUNT(*)
        FROM tbl_wallet_history
        WHERE user_id = #{userId}
    </select>

</mapper>
